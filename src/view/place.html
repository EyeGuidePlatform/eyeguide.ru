{% extends "templates/pageTemplate.html" %}

{% block commonStyles %}
<link rel="stylesheet" href="/css/style1.css">
<link rel="stylesheet" href="/css/slick.css">
<link href="/css/place.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="/slick/slick.css"/>
<link rel="stylesheet" type="text/css" href="/slick/slick-theme.css"/>
<script src="https://api-maps.yandex.ru/1.1/index.xml" type="text/javascript"></script>

 
 <script type="text/javascript">
     YMaps.jQuery(function () {
        // Создает экземпляр карты и привязывает его к созданному контейнеру
        var map = new YMaps.Map(YMaps.jQuery("#YMapsID")[0]);
    map.addControl(new YMaps.TypeControl());
    map.addControl(new YMaps.ToolBar());
    map.addControl(new YMaps.Zoom());
    map.addControl(new YMaps.MiniMap());
    map.addControl(new YMaps.ScaleLine());     
        // Устанавливает начальные параметры отображения карты: центр карты и коэффициент масштабирования
        map.setCenter(new YMaps.GeoPoint(+' {{place.geo.x}}', +' {{place.geo.y}}'), 10);
        let template = new YMaps.Template(
           '<div style="width: 300px; text-align:center"> \
               <img style="width: 90%" src="$[img]"> \
               <h3>$[name]</h3> \
               <p>$[description]</p> \
           </div>'
       );
    
       let s = new YMaps.Style();
       s.balloonContentStyle = new YMaps.BalloonContentStyle(template);
    
       let places = [
           {
               name: '{{place.name}}',
               description: '{{place.description}}',
               img: '/img/park_pobedy.jpg',
               geo: [+' {{place.geo.x}}', +'{{place.geo.y}}']
           },
         
       ];
    
       let pCollection = new YMaps.GeoObjectCollection();
       
       places.forEach( (place) => {
           let point = new YMaps.GeoPoint(place.geo[0], place.geo[1]);
           let placemark = new YMaps.Placemark(point, {style: s});
           placemark.name = place.name;
           placemark.description = place.description;
           placemark.img = place.img;
    
           pCollection.add(placemark);
       });
       
       map.addOverlay(pCollection);
       })
 </script>
{% endblock %}

{% block content %}
<div class="wrap">
        <div id="place">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <h1 class="place-name text-center">{{ place.name }}</h1>
                        <div class="place-img col-md-6 col-sm-6">
                            <div style="background-image: url('{{ place.img }}')" class="element-img col-md-12" id="Imgplace" ></div>
                        </div>  
                        <div class="place-info col-md-6 col-sm-6">
                            <h4>Описание:</h4>  
                            <h5>{{ place.description }}</h5>
                            <p>
                                 {{place.geo.x}} {{place.geo.y}}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
       <div id="car">
     <div class="container">
        <div class="col-xs-12">
            <h2 class="text-center">Гиды</h2>
            <div class="responsive">
                <!-- переделать через foreach в nunjucks !!!-->
                <div style="background-image: url('{{ place.img }}')" class="element-img col-md-12"></div>
                <div style="background-image: url('{{ place.img }}')" class="element-img col-md-12"></div>
                <div style="background-image: url('{{ place.img }}')" class="element-img col-md-12"></div>
                <div style="background-image: url('{{ place.img }}')" class="element-img col-md-12"></div>
                <div style="background-image: url('{{ place.img }}')" class="element-img col-md-12"></div>
            </div>
        </div>
    </div>
    </div>
    
    <div id="map">
        <div class="container">
            <div class="row centred">
                <div id="YMapsID" style="width:640px;height:480px" >
                    
                </div>
            </div>
        </div>
    </div>
    
    
    </div> 
  {% endblock %}

  {% block commonJS %}
  <script type="text/javascript" src="//code.jquery.com/jquery-1.11.0.min.js"></script>
  <script type="text/javascript" src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
  <script type="text/javascript" src="/slick/slick.min.js"></script>
  <script type="text/javascript" src="/js/slider.js"></script>
  <script src="/js/jquery-2.2.3.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  
  {% endblock %}
</body>
</html>
